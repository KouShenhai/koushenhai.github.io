<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Spring Cloud Gateway配置 | KCloud-Platform-IoT</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="一个企业级微服务架构的IoT云平台">
    <meta name="keywords" content="vuepress,theme,blog,vdoing">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.1d530ede.css" as="style"><link rel="preload" href="/assets/js/app.f3fd3477.js" as="script"><link rel="preload" href="/assets/js/4.4a1b9f8b.js" as="script"><link rel="preload" href="/assets/js/1.08101a30.js" as="script"><link rel="preload" href="/assets/js/3.57ce2480.js" as="script"><link rel="preload" href="/assets/js/56.ec49fb83.js" as="script"><link rel="prefetch" href="/assets/js/10.800b373e.js"><link rel="prefetch" href="/assets/js/11.018c06f8.js"><link rel="prefetch" href="/assets/js/12.989cb881.js"><link rel="prefetch" href="/assets/js/13.b2687a89.js"><link rel="prefetch" href="/assets/js/14.b170e7b8.js"><link rel="prefetch" href="/assets/js/15.68bcbef6.js"><link rel="prefetch" href="/assets/js/16.ea3c2918.js"><link rel="prefetch" href="/assets/js/17.974da1f7.js"><link rel="prefetch" href="/assets/js/18.8166579f.js"><link rel="prefetch" href="/assets/js/19.00d4def2.js"><link rel="prefetch" href="/assets/js/2.7718743e.js"><link rel="prefetch" href="/assets/js/20.af9a3da1.js"><link rel="prefetch" href="/assets/js/21.a5f5dd2e.js"><link rel="prefetch" href="/assets/js/22.26a48310.js"><link rel="prefetch" href="/assets/js/23.c0a60b60.js"><link rel="prefetch" href="/assets/js/24.57d7f1c8.js"><link rel="prefetch" href="/assets/js/25.af36e1cf.js"><link rel="prefetch" href="/assets/js/26.5b165ef7.js"><link rel="prefetch" href="/assets/js/27.121a426f.js"><link rel="prefetch" href="/assets/js/28.4346114a.js"><link rel="prefetch" href="/assets/js/29.73aa83c0.js"><link rel="prefetch" href="/assets/js/30.2045eab9.js"><link rel="prefetch" href="/assets/js/31.3de44d63.js"><link rel="prefetch" href="/assets/js/32.6d0a4721.js"><link rel="prefetch" href="/assets/js/33.d4e9d5f0.js"><link rel="prefetch" href="/assets/js/34.138cbacc.js"><link rel="prefetch" href="/assets/js/35.537e49dd.js"><link rel="prefetch" href="/assets/js/36.c6f11771.js"><link rel="prefetch" href="/assets/js/37.aa89c982.js"><link rel="prefetch" href="/assets/js/38.0573ac3d.js"><link rel="prefetch" href="/assets/js/39.2d9c5423.js"><link rel="prefetch" href="/assets/js/40.36eb0f20.js"><link rel="prefetch" href="/assets/js/41.c1ad1637.js"><link rel="prefetch" href="/assets/js/42.94eaa3fc.js"><link rel="prefetch" href="/assets/js/43.bf826d68.js"><link rel="prefetch" href="/assets/js/44.31598f11.js"><link rel="prefetch" href="/assets/js/45.4d498196.js"><link rel="prefetch" href="/assets/js/46.31948650.js"><link rel="prefetch" href="/assets/js/47.8295ef5b.js"><link rel="prefetch" href="/assets/js/48.c5c642ff.js"><link rel="prefetch" href="/assets/js/49.c51226fa.js"><link rel="prefetch" href="/assets/js/5.952108e8.js"><link rel="prefetch" href="/assets/js/50.368ae1ee.js"><link rel="prefetch" href="/assets/js/51.cffdbd18.js"><link rel="prefetch" href="/assets/js/52.54077e51.js"><link rel="prefetch" href="/assets/js/53.05868055.js"><link rel="prefetch" href="/assets/js/54.80e4e96f.js"><link rel="prefetch" href="/assets/js/55.9be8cf26.js"><link rel="prefetch" href="/assets/js/57.d5298434.js"><link rel="prefetch" href="/assets/js/58.68cd6919.js"><link rel="prefetch" href="/assets/js/59.4c353723.js"><link rel="prefetch" href="/assets/js/6.bd726b7f.js"><link rel="prefetch" href="/assets/js/7.0c069817.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.52229aeb.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1d530ede.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="KCloud-Platform-IoT" class="logo"> <span class="site-name can-hide">KCloud-Platform-IoT</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="二开指南" class="dropdown-title"><a href="/pages/a438ap/" class="link-title">二开指南</a> <span class="title" style="display:none;">二开指南</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>活动</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/a438ap/" class="nav-link">KCloud-Platform-IoT 开源三周年快乐&amp;父亲节快乐</a></li></ul></li><li class="dropdown-item"><h4>指南</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/caff79/" class="nav-link">后端项目启动</a></li><li class="dropdown-subitem"><a href="/pages/d38008/" class="nav-link">前端项目启动</a></li><li class="dropdown-subitem"><a href="/pages/511812/" class="nav-link">Docker安装</a></li><li class="dropdown-subitem"><a href="/pages/d55f5f/" class="nav-link">Linux常用命令</a></li><li class="dropdown-subitem"><a href="/pages/8300d6/" class="nav-link">Docker常用命令</a></li><li class="dropdown-subitem"><a href="/pages/dafd11/" class="nav-link">JVM性能优化</a></li><li class="dropdown-subitem"><a href="/pages/9cd6a1/" class="nav-link">项目配置</a></li><li class="dropdown-subitem"><a href="/pages/d29eab/" class="nav-link">COLA代码规范</a></li><li class="dropdown-subitem"><a href="/pages/029878/" class="nav-link">OAuth2.1授权服务器配置</a></li><li class="dropdown-subitem"><a href="/pages/029879/" class="nav-link">OAuth2.1资源服务器配置</a></li><li class="dropdown-subitem"><a href="/pages/3c002a/" class="nav-link">OAuth2.1认证API配置</a></li><li class="dropdown-subitem"><a href="/pages/bb6aae/" class="nav-link">Nacos配置</a></li><li class="dropdown-subitem"><a href="/pages/a0f8a0/" class="nav-link">网关路由配置</a></li><li class="dropdown-subitem"><a href="/pages/2e0e5f/" class="nav-link">项目常用注解</a></li><li class="dropdown-subitem"><a href="/pages/409dff/" class="nav-link">Elasticsearch注解</a></li><li class="dropdown-subitem"><a href="/pages/3cc49d/" class="nav-link">Spring Cloud Alibaba配置</a></li><li class="dropdown-subitem"><a href="/pages/4953b0/" aria-current="page" class="nav-link router-link-exact-active router-link-active">Spring Cloud Gateway配置</a></li><li class="dropdown-subitem"><a href="/pages/4953b1/" class="nav-link">17.gRPC配置</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/pages/1b12ed/" class="nav-link">赞助</a></div> <a href="https://github.com/KouShenhai/KCloud-Platform-IoT" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="二开指南" class="dropdown-title"><a href="/pages/a438ap/" class="link-title">二开指南</a> <span class="title" style="display:none;">二开指南</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>活动</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/a438ap/" class="nav-link">KCloud-Platform-IoT 开源三周年快乐&amp;父亲节快乐</a></li></ul></li><li class="dropdown-item"><h4>指南</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/caff79/" class="nav-link">后端项目启动</a></li><li class="dropdown-subitem"><a href="/pages/d38008/" class="nav-link">前端项目启动</a></li><li class="dropdown-subitem"><a href="/pages/511812/" class="nav-link">Docker安装</a></li><li class="dropdown-subitem"><a href="/pages/d55f5f/" class="nav-link">Linux常用命令</a></li><li class="dropdown-subitem"><a href="/pages/8300d6/" class="nav-link">Docker常用命令</a></li><li class="dropdown-subitem"><a href="/pages/dafd11/" class="nav-link">JVM性能优化</a></li><li class="dropdown-subitem"><a href="/pages/9cd6a1/" class="nav-link">项目配置</a></li><li class="dropdown-subitem"><a href="/pages/d29eab/" class="nav-link">COLA代码规范</a></li><li class="dropdown-subitem"><a href="/pages/029878/" class="nav-link">OAuth2.1授权服务器配置</a></li><li class="dropdown-subitem"><a href="/pages/029879/" class="nav-link">OAuth2.1资源服务器配置</a></li><li class="dropdown-subitem"><a href="/pages/3c002a/" class="nav-link">OAuth2.1认证API配置</a></li><li class="dropdown-subitem"><a href="/pages/bb6aae/" class="nav-link">Nacos配置</a></li><li class="dropdown-subitem"><a href="/pages/a0f8a0/" class="nav-link">网关路由配置</a></li><li class="dropdown-subitem"><a href="/pages/2e0e5f/" class="nav-link">项目常用注解</a></li><li class="dropdown-subitem"><a href="/pages/409dff/" class="nav-link">Elasticsearch注解</a></li><li class="dropdown-subitem"><a href="/pages/3cc49d/" class="nav-link">Spring Cloud Alibaba配置</a></li><li class="dropdown-subitem"><a href="/pages/4953b0/" aria-current="page" class="nav-link router-link-exact-active router-link-active">Spring Cloud Gateway配置</a></li><li class="dropdown-subitem"><a href="/pages/4953b1/" class="nav-link">17.gRPC配置</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/pages/1b12ed/" class="nav-link">赞助</a></div> <a href="https://github.com/KouShenhai/KCloud-Platform-IoT" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>活动</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/a438ap/" class="sidebar-link">KCloud-Platform-IoT 开源三周年快乐&amp;父亲节快乐</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>指南</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/caff79/" class="sidebar-link">后端项目启动</a></li><li><a href="/pages/d38008/" class="sidebar-link">前端项目启动</a></li><li><a href="/pages/511812/" class="sidebar-link">Docker安装</a></li><li><a href="/pages/d55f5f/" class="sidebar-link">Linux常用命令</a></li><li><a href="/pages/8300d6/" class="sidebar-link">Docker常用命令</a></li><li><a href="/pages/dafd11/" class="sidebar-link">JVM性能优化</a></li><li><a href="/pages/9cd6a1/" class="sidebar-link">项目配置</a></li><li><a href="/pages/d29eab/" class="sidebar-link">COLA代码规范</a></li><li><a href="/pages/029878/" class="sidebar-link">OAuth2.1授权服务器配置</a></li><li><a href="/pages/029879/" class="sidebar-link">OAuth2.1资源服务器配置</a></li><li><a href="/pages/3c002a/" class="sidebar-link">OAuth2.1认证API配置</a></li><li><a href="/pages/bb6aae/" class="sidebar-link">Nacos配置</a></li><li><a href="/pages/a0f8a0/" class="sidebar-link">网关路由配置</a></li><li><a href="/pages/2e0e5f/" class="sidebar-link">项目常用注解</a></li><li><a href="/pages/409dff/" class="sidebar-link">Elasticsearch注解</a></li><li><a href="/pages/3cc49d/" class="sidebar-link">Spring Cloud Alibaba配置</a></li><li><a href="/pages/4953b0/" aria-current="page" class="active sidebar-link">Spring Cloud Gateway配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/4953b0/#介绍" class="sidebar-link">介绍</a></li><li class="sidebar-sub-header level2"><a href="/pages/4953b0/#配置方式" class="sidebar-link">配置方式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/4953b0/#_1-简单路由配置" class="sidebar-link">1. 简单路由配置</a></li><li class="sidebar-sub-header level3"><a href="/pages/4953b0/#_2-常用断言-predicates" class="sidebar-link">2. 常用断言 (Predicates)</a></li><li class="sidebar-sub-header level3"><a href="/pages/4953b0/#_3-常用过滤器-filters" class="sidebar-link">3. 常用过滤器 (Filters)</a></li><li class="sidebar-sub-header level3"><a href="/pages/4953b0/#_4-全局过滤器-global-filters" class="sidebar-link">4. 全局过滤器 (Global Filters)</a></li><li class="sidebar-sub-header level3"><a href="/pages/4953b0/#_5-跨域配置-cors" class="sidebar-link">5. 跨域配置 (CORS)</a></li><li class="sidebar-sub-header level3"><a href="/pages/4953b0/#_6-错误处理" class="sidebar-link">6. 错误处理</a></li><li class="sidebar-sub-header level3"><a href="/pages/4953b0/#_7-总结" class="sidebar-link">7. 总结</a></li></ul></li></ul></li><li><a href="/pages/4953b1/" class="sidebar-link">gRPC配置</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>二开指南</span></li><li data-v-06225672><span data-v-06225672>指南</span></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/KouShenhai" target="_blank" title="作者" class="beLink" data-v-06225672>KCloud-Platform-IoT</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2026-02-11</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">Spring Cloud Gateway配置<!----></h1>  <div class="theme-vdoing-content content__default"><p>你好呀，我的老朋友！我是老寇，欢迎来到老寇IoT云平台！</p> <h2 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍</h2> <p><a href="https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html" target="_blank" rel="noopener noreferrer">Spring Cloud Gateway官方地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>提供了一个建立在 Spring 生态系统之上的 API 网关，包括：Spring Framework 7、Spring Boot 4 和 Project Reactor。
Spring Cloud Gateway旨在提供一种简单而有效的方法来路由到API，并为它们提供跨领域关注点，例如：安全性，监控/指标、限流、路由等等。</p> <p><font color="red">注意</font></p> <ul><li>不启用网关，请设置 <code>spring.cloud.gateway.enabled=false</code></li> <li>Spring Cloud Gateway需要运行在由Spring Webflux（响应式）提供的Netty容器，不适用于传统的Servlet容器或作为WAR构建</li></ul> <p><font color="red">核心概念</font></p> <ul><li><strong>Route (路由)</strong>：网关的基本构建块。它由一个 ID、一个目标 URI、一组断言 (Predicates) 和一组过滤器 (Filters) 组成，如果满足Predicate，则匹配路由。</li> <li><strong>Predicate (断言)</strong>：断言，这是jdk8 断言函数，输入类型是 <code>Spring Framework ServerWebExchange</code>,用于匹配 HTTP 请求的条件。如果请求匹配断言，则路由会被执行，例如请求头或参数。</li> <li><strong>Filter (过滤器)</strong>：是使用特定工厂构造的 <code>GatewayFilter</code> 实例，分为两种类型，分别是Gateway Filter（某个路由过滤器）和Global Filter（全局过滤器），在请求被路由到目标服务之前或之后对请求或响应进行修改。</li></ul> <p><font color="red">流程图</font></p> <img height="700" src="/img/Spring Cloud Gateway配置/img.png"> <h2 id="配置方式"><a href="#配置方式" class="header-anchor">#</a> 配置方式</h2> <h3 id="_1-简单路由配置"><a href="#_1-简单路由配置" class="header-anchor">#</a> 1. 简单路由配置</h3> <p>最基本的路由配置包括一个 ID、一个目标 URI 和至少一个断言。</p> <p><strong>配置示例 (<code>application.yml</code>)</strong></p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> example_route
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">8081</span> <span class="token comment"># 目标服务地址</span>
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/example/<span class="token important">**</span> <span class="token comment"># 当请求路径匹配 /example/** 时，路由到目标服务</span>
</code></pre></div><p><strong>说明</strong></p> <ul><li><code>id</code>: 路由的唯一标识符。</li> <li><code>uri</code>: 目标服务的 URI。可以是 <code>http://</code>、<code>https://</code>、<code>lb://</code> (用于负载均衡) 等。</li> <li><code>predicates</code>: 断言列表。这里使用了 <code>Path</code> 断言，表示当请求路径符合 <code>/example/**</code> 时，该路由生效。</li></ul> <h3 id="_2-常用断言-predicates"><a href="#_2-常用断言-predicates" class="header-anchor">#</a> 2. 常用断言 (Predicates)</h3> <p>Spring Cloud Gateway 提供了多种内置断言，用于匹配不同的请求条件。</p> <table><thead><tr><th style="text-align:left;">断言名称</th> <th style="text-align:left;">描述</th> <th style="text-align:left;">示例</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>Path</code></td> <td style="text-align:left;">根据请求路径匹配</td> <td style="text-align:left;"><code>Path=/foo/{segment}</code></td></tr> <tr><td style="text-align:left;"><code>Host</code></td> <td style="text-align:left;">根据请求的 Host 头匹配</td> <td style="text-align:left;"><code>Host=**.somehost.org,**.anotherhost.org</code></td></tr> <tr><td style="text-align:left;"><code>Method</code></td> <td style="text-align:left;">根据请求的 HTTP 方法匹配</td> <td style="text-align:left;"><code>Method=GET,POST</code></td></tr> <tr><td style="text-align:left;"><code>Header</code></td> <td style="text-align:left;">根据请求头匹配</td> <td style="text-align:left;"><code>Header=X-Request-Id, \d+</code></td></tr> <tr><td style="text-align:left;"><code>Query</code></td> <td style="text-align:left;">根据请求参数匹配</td> <td style="text-align:left;"><code>Query=baz</code> 或 <code>Query=foo,bar</code></td></tr> <tr><td style="text-align:left;"><code>Cookie</code></td> <td style="text-align:left;">根据 Cookie 匹配</td> <td style="text-align:left;"><code>Cookie=baz,foo</code></td></tr> <tr><td style="text-align:left;"><code>After</code></td> <td style="text-align:left;">在指定时间之后匹配</td> <td style="text-align:left;"><code>After=2023-01-01T12:00:00+08:00[Asia/Shanghai]</code></td></tr> <tr><td style="text-align:left;"><code>Before</code></td> <td style="text-align:left;">在指定时间之前匹配</td> <td style="text-align:left;"><code>Before=2023-01-01T12:00:00+08:00[Asia/Shanghai]</code></td></tr> <tr><td style="text-align:left;"><code>Between</code></td> <td style="text-align:left;">在两个指定时间之间匹配</td> <td style="text-align:left;"><code>Between=2023-01-01T12:00:00+08:00[Asia/Shanghai],2023-01-31T12:00:00+08:00[Asia/Shanghai]</code></td></tr> <tr><td style="text-align:left;"><code>RemoteAddr</code></td> <td style="text-align:left;">根据远程 IP 地址匹配</td> <td style="text-align:left;"><code>RemoteAddr=192.168.1.1/24</code></td></tr> <tr><td style="text-align:left;"><code>Weight</code></td> <td style="text-align:left;">用于 A/B 测试或灰度发布，根据权重进行路由</td> <td style="text-align:left;"><code>Weight=group1, 80</code></td></tr></tbody></table> <p><strong>配置示例 (多个断言)</strong></p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> user_service_route
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//user<span class="token punctuation">-</span>service <span class="token comment"># 使用负载均衡到名为 user-service 的服务</span>
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/users/<span class="token important">**</span>
            <span class="token punctuation">-</span> Method=GET<span class="token punctuation">,</span>POST
            <span class="token punctuation">-</span> Header=X<span class="token punctuation">-</span>Version<span class="token punctuation">,</span> v1 <span class="token comment"># 请求头 X-Version 必须为 v1</span>
</code></pre></div><p><strong>说明</strong></p> <ul><li><code>lb://user-service</code>: <code>lb</code> 前缀表示使用 Spring Cloud LoadBalancer 进行负载均衡，<code>user-service</code> 是注册中心中的服务名。</li> <li>当一个路由配置了多个断言时，只有当所有断言都匹配成功时，该路由才会生效。</li></ul> <h3 id="_3-常用过滤器-filters"><a href="#_3-常用过滤器-filters" class="header-anchor">#</a> 3. 常用过滤器 (Filters)</h3> <p>过滤器允许您在请求被路由到目标服务之前或之后修改请求和响应。</p> <table><thead><tr><th style="text-align:left;">过滤器名称</th> <th style="text-align:left;">描述</th> <th style="text-align:left;">示例</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>AddRequestHeader</code></td> <td style="text-align:left;">添加请求头</td> <td style="text-align:left;"><code>AddRequestHeader=X-Request-Foo, Bar</code></td></tr> <tr><td style="text-align:left;"><code>AddResponseHeader</code></td> <td style="text-align:left;">添加响应头</td> <td style="text-align:left;"><code>AddResponseHeader=X-Response-Foo, Bar</code></td></tr> <tr><td style="text-align:left;"><code>RemoveRequestHeader</code></td> <td style="text-align:left;">移除请求头</td> <td style="text-align:left;"><code>RemoveRequestHeader=X-Request-Foo</code></td></tr> <tr><td style="text-align:left;"><code>RemoveResponseHeader</code></td> <td style="text-align:left;">移除响应头</td> <td style="text-align:left;"><code>RemoveResponseHeader=X-Response-Foo</code></td></tr> <tr><td style="text-align:left;"><code>RewritePath</code></td> <td style="text-align:left;">重写请求路径</td> <td style="text-align:left;"><code>RewritePath=/foo/(?.*), /${remaining}</code></td></tr> <tr><td style="text-align:left;"><code>PrefixPath</code></td> <td style="text-align:left;">给请求路径添加前缀</td> <td style="text-align:left;"><code>PrefixPath=/my-prefix</code></td></tr> <tr><td style="text-align:left;"><code>StripPrefix</code></td> <td style="text-align:left;">移除请求路径中的前缀</td> <td style="text-align:left;"><code>StripPrefix=1</code> (移除一个路径段)</td></tr> <tr><td style="text-align:left;"><code>Retry</code></td> <td style="text-align:left;">重试机制</td> <td style="text-align:left;"><code>Retry=3</code> (重试 3 次)</td></tr> <tr><td style="text-align:left;"><code>CircuitBreaker</code></td> <td style="text-align:left;">熔断器 (与 Resilience4j 或 Hystrix 集成)</td> <td style="text-align:left;"><code>CircuitBreaker=myCircuitBreaker</code></td></tr> <tr><td style="text-align:left;"><code>RequestRateLimiter</code></td> <td style="text-align:left;">请求速率限制 (基于 Redis 或其他)</td> <td style="text-align:left;"><code>RequestRateLimiter=#{#user.name}, 1, 1, 10</code> (用户名为 key，每秒 1 个请求，突发 1 个，令牌桶容量 10)</td></tr> <tr><td style="text-align:left;"><code>RedirectTo</code></td> <td style="text-align:left;">重定向</td> <td style="text-align:left;"><code>RedirectTo=302, https://example.com</code></td></tr></tbody></table> <p><strong>配置示例 (过滤器)</strong></p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> api_route
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">8082</span>
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/api/<span class="token important">**</span>
          <span class="token key atrule">filters</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> StripPrefix=1 <span class="token comment"># 移除 /api 前缀，例如 /api/v1/users -&gt; /v1/users</span>
            <span class="token punctuation">-</span> AddRequestHeader=X<span class="token punctuation">-</span>Custom<span class="token punctuation">-</span>Header<span class="token punctuation">,</span> Gateway<span class="token punctuation">-</span>Request <span class="token comment"># 添加自定义请求头</span>
            <span class="token punctuation">-</span> <span class="token key atrule">RequestRateLimiter</span><span class="token punctuation">:</span> <span class="token comment"># 速率限制</span>
                <span class="token key atrule">key-resolver</span><span class="token punctuation">:</span> <span class="token string">'#{@ipAddressKeyResolver}'</span> <span class="token comment"># 使用 SpEL 表达式定义限流 key</span>
                <span class="token key atrule">redis-rate-limiter.replenishRate</span><span class="token punctuation">:</span> <span class="token number">1</span> <span class="token comment"># 每秒允许多少个请求</span>
                <span class="token key atrule">redis-rate-limiter.burstCapacity</span><span class="token punctuation">:</span> <span class="token number">2</span> <span class="token comment"># 令牌桶的容量</span>
                <span class="token key atrule">redis-rate-limiter.requestedTokens</span><span class="token punctuation">:</span> <span class="token number">1</span> <span class="token comment"># 每次请求消耗的令牌数</span>
</code></pre></div><p><strong>说明</strong></p> <ul><li><code>StripPrefix=1</code>: 移除请求路径的第一个路径段。</li> <li><code>AddRequestHeader</code>: 添加一个名为 <code>X-Custom-Header</code>，值为 <code>Gateway-Request</code> 的请求头。</li> <li><code>RequestRateLimiter</code>: 配置请求速率限制。
<ul><li><code>key-resolver</code>: 定义用于限流的 key。这里使用了 <code>@ipAddressKeyResolver</code>，需要您在 Spring 容器中定义一个 <code>KeyResolver</code> Bean。</li> <li><code>redis-rate-limiter.replenishRate</code>: 令牌桶每秒填充的平均速率。</li> <li><code>redis-rate-limiter.burstCapacity</code>: 令牌桶的容量，允许的突发请求数。</li> <li><code>redis-rate-limiter.requestedTokens</code>: 每次请求消耗的令牌数。</li></ul></li></ul> <h3 id="_4-全局过滤器-global-filters"><a href="#_4-全局过滤器-global-filters" class="header-anchor">#</a> 4. 全局过滤器 (Global Filters)</h3> <p>全局过滤器应用于所有路由。它们通过实现 <code>GlobalFilter</code> 接口或使用 <code>spring.cloud.gateway.default-filters</code> 配置。</p> <p><strong>配置示例 (默认过滤器)</strong></p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">default-filters</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> AddResponseHeader=X<span class="token punctuation">-</span>Global<span class="token punctuation">-</span>Header<span class="token punctuation">,</span> Global<span class="token punctuation">-</span>Value <span class="token comment"># 为所有响应添加一个全局头</span>
        <span class="token punctuation">-</span> PrefixPath=/global<span class="token punctuation">-</span>prefix <span class="token comment"># 为所有请求路径添加前缀</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> service_a
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">8083</span>
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/serviceA/<span class="token important">**</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> service_b
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">8084</span>
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/serviceB/<span class="token important">**</span>
</code></pre></div><p><strong>说明</strong></p> <ul><li><code>default-filters</code>: 定义的过滤器将应用于所有路由。</li></ul> <h3 id="_5-跨域配置-cors"><a href="#_5-跨域配置-cors" class="header-anchor">#</a> 5. 跨域配置 (CORS)</h3> <p>Spring Cloud Gateway 支持配置 CORS。</p> <p><strong>配置示例</strong></p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">globalcors</span><span class="token punctuation">:</span>
        <span class="token key atrule">cors-configurations</span><span class="token punctuation">:</span>
          <span class="token key atrule">'[/**]'</span><span class="token punctuation">:</span> <span class="token comment"># 匹配所有路径</span>
            <span class="token key atrule">allowedOrigins</span><span class="token punctuation">:</span> <span class="token string">&quot;http://localhost:8080&quot;</span> <span class="token comment"># 允许的来源</span>
            <span class="token key atrule">allowedMethods</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> GET
              <span class="token punctuation">-</span> POST
              <span class="token punctuation">-</span> PUT
              <span class="token punctuation">-</span> DELETE
            <span class="token key atrule">allowedHeaders</span><span class="token punctuation">:</span> <span class="token string">&quot;*&quot;</span> <span class="token comment"># 允许所有请求头</span>
            <span class="token key atrule">allowCredentials</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># 允许发送 Cookie</span>
            <span class="token key atrule">maxAge</span><span class="token punctuation">:</span> <span class="token number">3600</span> <span class="token comment"># 预检请求的缓存时间</span>
</code></pre></div><p><strong>说明</strong></p> <ul><li><code>globalcors</code>: 全局 CORS 配置。</li> <li><code>cors-configurations</code>: 具体的 CORS 规则。</li> <li><code>[/**]</code>: 匹配所有路径。</li> <li><code>allowedOrigins</code>: 允许的源。</li> <li><code>allowedMethods</code>: 允许的 HTTP 方法。</li> <li><code>allowedHeaders</code>: 允许的请求头。</li> <li><code>allowCredentials</code>: 是否允许发送凭证（如 Cookie）。</li> <li><code>maxAge</code>: 预检请求的有效期。</li></ul> <h3 id="_6-错误处理"><a href="#_6-错误处理" class="header-anchor">#</a> 6. 错误处理</h3> <p>Spring Cloud Gateway 提供了默认的错误处理机制，也可以自定义。</p> <p><strong>自定义错误页面 (示例)</strong></p> <p>通常通过实现 <code>ErrorWebExceptionHandler</code> 接口来定制错误处理逻辑。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 示例代码，非配置</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Order</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// 优先级要高于 Gateway 的默认错误处理器</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomErrorWebExceptionHandler</span> <span class="token keyword">implements</span> <span class="token class-name">ErrorWebExceptionHandler</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Mono</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token class-name">ServerWebExchange</span> exchange<span class="token punctuation">,</span> <span class="token class-name">Throwable</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 自定义错误处理逻辑，例如返回 JSON 格式的错误信息</span>
        <span class="token class-name">ServerHttpResponse</span> response <span class="token operator">=</span> exchange<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">setStatusCode</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">INTERNAL_SERVER_ERROR</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">APPLICATION_JSON</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> errorMsg <span class="token operator">=</span> <span class="token string">&quot;Gateway Error: &quot;</span> <span class="token operator">+</span> ex<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">DataBuffer</span> buffer <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">bufferFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span>errorMsg<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">writeWith</span><span class="token punctuation">(</span><span class="token class-name">Mono</span><span class="token punctuation">.</span><span class="token function">just</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_7-总结"><a href="#_7-总结" class="header-anchor">#</a> 7. 总结</h3> <p>Spring Cloud Gateway 是一个功能强大且灵活的 API 网关，通过其丰富的断言和过滤器，可以实现复杂的路由逻辑、请求/响应转换、安全控制、流量管理等功能。理解其核心概念和配置方式是构建健壮微服务架构的关键。</p> <p>我是老寇，我们下次再见啦！</p></div></div>  <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2/26/2026, 12:59:04 AM</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/3cc49d/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Spring Cloud Alibaba配置</div></a> <a href="/pages/4953b1/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">gRPC配置</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/3cc49d/" class="prev">Spring Cloud Alibaba配置</a></span> <span class="next"><a href="/pages/4953b1/">gRPC配置</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:2413176044@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/KouShenhai" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2026
    <span>laokou | Apache 2.0 License</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.f3fd3477.js" defer></script><script src="/assets/js/4.4a1b9f8b.js" defer></script><script src="/assets/js/1.08101a30.js" defer></script><script src="/assets/js/3.57ce2480.js" defer></script><script src="/assets/js/56.ec49fb83.js" defer></script>
  </body>
</html>
